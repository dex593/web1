<!DOCTYPE html>
<html lang="vi">
  <%- include("../partials/head", { title }) %>
  <body>
    <div class="site admin">
      <main>
        <section class="section container admin-auth">
          <% if (passwordEnabled) { %>
            <form class="panel admin-card" method="post" action="/admin/login">
              <h1>Đăng nhập quản trị</h1>
              <p class="note">Truy cập dành riêng cho BFANG Team.</p>
              <input type="hidden" name="next" value="<%= nextTarget || '' %>" />
              <input type="hidden" name="fallback" value="<%= fallbackTarget || '' %>" />
              <% if (error) { %>
                <p class="admin-error"><%= error %></p>
              <% } %>
              <label class="admin-field">
                <span>Tài khoản</span>
                <input type="text" name="username" autocomplete="username" required />
              </label>
              <label class="admin-field">
                <span>Mật khẩu</span>
                <input type="password" name="password" autocomplete="current-password" required />
              </label>
              <button class="button" type="submit">Đăng nhập</button>
            </form>
          <% } else { %>
            <div class="panel admin-card">
              <h1>Đăng nhập quản trị</h1>
              <p class="admin-error"><%= passwordDisabledReason || "Chưa cấu hình ADMIN_USER/ADMIN_PASS trong .env." %></p>
              <p class="note">Bạn vẫn có thể đăng nhập bằng Google hoặc Discord nếu tài khoản có huy hiệu Admin.</p>
            </div>
          <% } %>

          <div
            class="panel admin-card"
            data-admin-sso-card
            data-next-target="<%= nextTarget || '' %>"
            data-fallback-target="<%= fallbackTarget || '' %>"
          >
            <h2>Đăng nhập</h2>
            <p class="note">Chỉ tài khoản có huy hiệu <strong>Admin</strong> mới vào được trang admin.</p>
            <p class="admin-error" hidden data-admin-sso-error></p>
            <p class="note" hidden data-admin-sso-status></p>
            <div class="admin-actions">
              <button class="button" type="button" data-auth-login>Đăng nhập</button>
            </div>
          </div>
        </section>
      </main>
    </div>
    <script src="<%= cacheBust("/admin-sso.js", assetVersion) %>" defer></script>
  </body>
</html>
