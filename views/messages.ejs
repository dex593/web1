<!DOCTYPE html>
<html lang="vi">
  <%- include("partials/head", { title }) %>
  <body data-disable-notifications-client="1">
    <div class="site site--chat">
      <%- include("partials/header") %>
      <main class="chat-layout" data-chat-page>
        <aside class="chat-sidebar">
          <div class="chat-sidebar__head">
            <div class="chat-sidebar__title-row">
              <h1>Đoạn chat</h1>
              <button
                class="chat-icon-btn chat-sidebar-toggle"
                type="button"
                data-chat-sidebar-toggle
                title="Thu gọn cột đoạn chat"
                aria-label="Thu gọn cột đoạn chat"
              >
                <i class="fa-solid fa-angles-left" aria-hidden="true"></i>
              </button>
            </div>
            <label class="chat-search-field" aria-label="Tìm kiếm thành viên">
              <i class="fa-solid fa-magnifying-glass" aria-hidden="true"></i>
              <input type="search" maxlength="40" placeholder="Tìm kiếm thành viên" data-chat-user-search />
            </label>
          </div>

          <div class="chat-sidebar__body">
            <div class="chat-search-results" data-chat-search-results hidden></div>
            <div class="chat-thread-list" data-chat-thread-list></div>
          </div>
        </aside>
        <button class="chat-sidebar-overlay" type="button" data-chat-sidebar-overlay hidden aria-label="Đóng danh sách đoạn chat"></button>

        <section class="chat-main">
          <div class="chat-main__head" data-chat-main-head>
            <div class="chat-main__head-start">
              <button
                class="chat-icon-btn chat-main__sidebar-toggle"
                type="button"
                data-chat-sidebar-toggle
                title="Mở danh sách đoạn chat"
                aria-label="Mở danh sách đoạn chat"
              >
                <i class="fa-solid fa-bars" aria-hidden="true"></i>
              </button>
              <div class="chat-peer">
                <span class="chat-peer__avatar" data-chat-peer-avatar>
                  <i class="fa-regular fa-user" aria-hidden="true"></i>
                </span>
                <span class="chat-peer__meta">
                  <a class="chat-peer__name-link is-disabled" href="#" aria-disabled="true" data-chat-peer-link>
                    <strong data-chat-peer-name>Chọn đoạn chat</strong>
                  </a>
                </span>
              </div>
            </div>
            <div class="chat-main__actions">
              <button class="chat-icon-btn" type="button" data-chat-info-button title="Thông tin người dùng" disabled>
                <i class="fa-solid fa-circle-info" aria-hidden="true"></i>
              </button>
            </div>
          </div>
          <div class="chat-message-list" data-chat-message-list></div>
          <form class="chat-compose" data-chat-compose>
            <div class="chat-compose__tools" data-chat-tools>
              <details class="chat-picker" data-chat-emoji-picker>
                <summary class="chat-picker__trigger" title="Emoji">
                  <i class="fa-regular fa-face-smile" aria-hidden="true"></i>
                </summary>
                <div class="chat-picker__panel chat-picker__panel--emoji" data-chat-emoji-panel></div>
              </details>
              <details class="chat-picker" data-chat-sticker-picker>
                <summary class="chat-picker__trigger" title="Sticker">
                  <i class="fa-regular fa-note-sticky" aria-hidden="true"></i>
                </summary>
                <div class="chat-picker__panel chat-picker__panel--sticker" data-chat-sticker-panel></div>
              </details>
              <p class="note chat-compose__counter" data-chat-counter>0/300</p>
            </div>
            <div class="chat-compose__input-wrap">
              <textarea maxlength="300" rows="1" placeholder="Aa" data-chat-input></textarea>
              <button class="chat-send-btn" type="submit" title="Gửi" aria-label="Gửi tin nhắn">
                <i class="fa-solid fa-paper-plane" aria-hidden="true"></i>
              </button>
            </div>
            <div class="chat-compose__meta">
              <p class="note" hidden data-chat-status></p>
            </div>
          </form>
        </section>
      </main>
    </div>
    <script>
      window.__CHAT_BOOTSTRAP = {
        currentUserId: <%- JSON.stringify(chatBootstrap && chatBootstrap.currentUserId ? chatBootstrap.currentUserId : "") %>,
        initialThreads: <%- JSON.stringify(Array.isArray(chatBootstrap && chatBootstrap.initialThreads) ? chatBootstrap.initialThreads : []) %>,
        initialThreadId: <%- JSON.stringify(chatBootstrap && chatBootstrap.initialThreadId ? chatBootstrap.initialThreadId : 0) %>,
        initialMessages: <%- JSON.stringify(Array.isArray(chatBootstrap && chatBootstrap.initialMessages) ? chatBootstrap.initialMessages : []) %>,
        initialMessagesHasMore: <%- JSON.stringify(Boolean(chatBootstrap && chatBootstrap.initialMessagesHasMore)) %>
      };
    </script>
    <script src="<%= cacheBust('/messages.js', assetVersion) %>" defer></script>
  </body>
</html>
